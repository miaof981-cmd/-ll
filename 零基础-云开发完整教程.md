# 🎓 零基础 - 云开发完整教程

> 本教程专为零基础用户编写，每一步都有详细说明和截图指引。

---

## 📌 开始之前

### 您需要：
- ✅ 已安装微信开发者工具
- ✅ 已打开您的小程序项目（就是当前这个项目）
- ✅ 项目能正常运行

### 您现在看到的界面应该是：
```
┌─────────────────────────────────────────┐
│ 微信开发者工具                            │
├─────────────────────────────────────────┤
│ 工具栏: 编译 | 预览 | 真机调试 | 云开发    │  ← 看这里！
├─────────────────────────────────────────┤
│  模拟器           │      代码编辑器         │
│                 │                        │
│  这里显示        │   这里是代码            │
│  小程序界面      │                        │
│                 │                        │
└─────────────────────────────────────────┘
```

---

## 🚀 第一步：打开云开发控制台

### 1. 找到"云开发"按钮

在微信开发者工具的**顶部工具栏**，找到一个按钮叫 **"云开发"**

位置：通常在 `编译`、`预览`、`真机调试` 后面

```
编译  |  预览  |  真机调试  |  【云开发】 ← 点这个！
```

### 2. 点击"云开发"按钮

**第一次点击**会弹出欢迎页面，提示您开通云开发。

### 3. 看到的界面

如果是**第一次使用云开发**，会看到：
```
┌──────────────────────────────────────┐
│          欢迎使用云开发                │
│                                      │
│     [立即开通]  按钮                   │
│                                      │
│  说明：云开发是微信提供的云端服务...     │
└──────────────────────────────────────┘
```

如果**已经开通过**，会直接进入云开发控制台。

---

## 🎯 第二步：开通云开发

### 1. 点击"立即开通"按钮

### 2. 填写信息

会弹出一个表单，需要填写：

| 字段 | 怎么填 | 示例 |
|------|--------|------|
| **环境名称** | 随便起个名字 | `school-prod` 或 `xuexiao` |
| **环境ID** | 系统自动生成，不用管 | `cloud-xxxxx`（自动的） |
| **付费方式** | 选择"按量付费" | ✅ 按量付费（有免费额度） |

### 3. 点击"创建"

等待几秒钟，系统会创建云环境。

### 4. 创建成功

会显示：
```
✅ 环境创建成功！
环境名称：school-prod
环境ID：cloud-xxxxx
```

**⚠️ 重要：请把这个环境ID记下来！**

例如：`cloud-2g6r8a5b0d5f4e3c`

建议：
- 复制环境ID
- 粘贴到记事本暂存
- 或者拍照保存

---

## 📂 第三步：创建数据库集合

### 1. 进入数据库页面

在云开发控制台，左侧菜单找到 **"数据库"**，点击进入。

```
云开发控制台
├── 概览
├── 【数据库】 ← 点这个
├── 存储
├── 云函数
└── 统计分析
```

### 2. 创建第一个集合

点击页面上的 **"添加集合"** 按钮。

会弹出一个小窗口：
```
┌─────────────────────────┐
│  添加集合                 │
├─────────────────────────┤
│  集合名称: [_________]   │ ← 在这里输入
│                         │
│  权限设置: [下拉菜单▼]   │
│                         │
│     [取消]  [确定]       │
└─────────────────────────┘
```

#### 输入信息：

**集合名称**：`photographers`  
（一个字母都不能错，直接复制粘贴）

**权限设置**：选择 **"仅创建者可读写"**

点击 **"确定"**

### 3. 创建剩余5个集合

重复上面的操作，再创建5个集合：

| 集合名称 | 说明 | 权限 |
|---------|------|------|
| `students` | 学生信息 | 仅创建者可读写 |
| `applications` | 申请订单 | 仅创建者可读写 |
| `announcements` | 公告 | 仅创建者可读写 |
| `banners` | 轮播图 | 仅创建者可读写 |
| `archives` | 学籍档案 | 仅创建者可读写 |

### 4. 检查

创建完成后，数据库页面应该显示6个集合：

```
数据库
├── photographers   (0条记录)
├── students        (0条记录)
├── applications    (0条记录)
├── announcements   (0条记录)
├── banners         (0条记录)
└── archives        (0条记录)
```

---

## ☁️ 第四步：上传云函数

### 1. 回到代码编辑器

关闭云开发控制台窗口，回到微信开发者工具的主界面。

### 2. 找到cloudfunctions文件夹

在左侧**文件目录**中，找到 `cloudfunctions` 文件夹：

```
项目目录
├── miniprogram/
├── 【cloudfunctions/】 ← 展开这个
│   ├── photographers/
│   ├── students/
│   └── applications/
├── admin/
└── README.md
```

### 3. 上传第一个云函数

**右键点击** `photographers` 文件夹，会弹出菜单：

```
┌─────────────────────────────┐
│ 在编辑器中显示               │
│ 在访达中显示                 │
│ ─────────────────────       │
│ 【上传并部署：云端安装依赖】  │ ← 点这个！
│ 上传并部署：所有文件          │
│ 云函数增量上传                │
│ ─────────────────────       │
│ 下载云端文件                  │
└─────────────────────────────┘
```

点击 **"上传并部署：云端安装依赖"**

### 4. 等待上传

会显示上传进度：
```
正在上传云函数 photographers...
正在安装依赖...
上传成功 ✅
```

### 5. 上传剩余2个云函数

重复上面的操作，依次上传：
- 右键 `students` → 上传并部署：云端安装依赖
- 右键 `applications` → 上传并部署：云端安装依赖

### 6. 验证

点击顶部 **"云开发"** 按钮，进入控制台，左侧点击 **"云函数"**。

应该看到3个云函数：

```
云函数列表
├── photographers   ✅ 已部署
├── students        ✅ 已部署
└── applications    ✅ 已部署
```

---

## 🔗 第五步：开启HTTP触发器

> 这一步很重要！让Web管理后台能调用云函数。

### 1. 进入云函数页面

在云开发控制台，左侧点击 **"云函数"**

### 2. 点击第一个云函数

点击 `photographers`，进入详情页

### 3. 找到"触发器配置"

在详情页往下滚动，找到 **"触发器配置"** 区域。

### 4. 添加触发器

点击 **"添加触发器"** 按钮

弹出窗口：
```
┌─────────────────────────┐
│  添加触发器               │
├─────────────────────────┤
│  触发器名称: [_______]   │ ← 随便填，例如：http
│                         │
│  触发类型: [下拉菜单▼]   │ ← 选择 HTTP
│                         │
│     [取消]  [确定]       │
└─────────────────────────┘
```

**触发器名称**：随便填，例如 `http`  
**触发类型**：选择 **HTTP**

点击 **"确定"**

### 5. 复制HTTP地址

创建成功后，会显示HTTP触发器地址：

```
触发器列表
─────────────────────────────────────
名称: http
类型: HTTP
路径: https://cloud-xxxxx.service.tcloudbase.com/photographers
                         ↑
                   复制这个完整地址！
```

**⚠️ 重要：把这个地址复制保存！**

格式类似：
```
https://cloud-xxxxx.service.tcloudbase.com/photographers
```

### 6. 对另外2个云函数重复操作

- 进入 `students` 云函数 → 添加HTTP触发器 → 复制地址
- 进入 `applications` 云函数 → 添加HTTP触发器 → 复制地址

### 7. 最终您应该有3个HTTP地址

```
photographers: https://cloud-xxxxx.service.tcloudbase.com/photographers
students:      https://cloud-xxxxx.service.tcloudbase.com/students
applications:  https://cloud-xxxxx.service.tcloudbase.com/applications
```

**⚠️ 请把这3个地址保存到记事本！**

---

## ⚙️ 第六步：配置环境ID

### 配置1：小程序端

#### 1. 打开文件

在微信开发者工具左侧文件列表，找到并打开：

```
miniprogram/app.js
```

#### 2. 找到第5行

```javascript
1  // app.js
2  App({
3    onLaunch() {
4      // 根据是否正确配置环境 ID 决定是否启用云开发
5      const envId = 'school-env-xxxxx'; // 请替换为您的云环境 ID
6      const canUseCloud = !!wx.cloud && envId && !/xxxxx/i.test(envId);
...
```

#### 3. 修改第5行

把 `'school-env-xxxxx'` 改为您的环境ID：

**修改前：**
```javascript
const envId = 'school-env-xxxxx'; // 请替换为您的云环境 ID
```

**修改后：**（假设您的环境ID是 `cloud-2g6r8a5b0d5f4e3c`）
```javascript
const envId = 'cloud-2g6r8a5b0d5f4e3c'; // 已配置云环境ID
```

#### 4. 保存文件

按 `Ctrl+S`（Windows）或 `Cmd+S`（Mac）保存

---

### 配置2：Web管理后台

#### 1. 打开文件

找到并打开：

```
admin/js/cloud-api.js
```

#### 2. 找到第7-11行

```javascript
7    baseURL: {
8      photographers: 'https://your-env-id.service.tcloudbase.com/photographers',
9      students: 'https://your-env-id.service.tcloudbase.com/students',
10     applications: 'https://your-env-id.service.tcloudbase.com/applications'
11   },
```

#### 3. 替换3个地址

把 `your-env-id` 替换为您的真实HTTP触发器地址：

**修改前：**
```javascript
baseURL: {
  photographers: 'https://your-env-id.service.tcloudbase.com/photographers',
  students: 'https://your-env-id.service.tcloudbase.com/students',
  applications: 'https://your-env-id.service.tcloudbase.com/applications'
},
```

**修改后：**（用您在第五步保存的3个地址）
```javascript
baseURL: {
  photographers: 'https://cloud-xxxxx.service.tcloudbase.com/photographers',
  students: 'https://cloud-xxxxx.service.tcloudbase.com/students',
  applications: 'https://cloud-xxxxx.service.tcloudbase.com/applications'
},
```

#### 4. 保存文件

按 `Ctrl+S` 或 `Cmd+S` 保存

---

## ✅ 第七步：测试

### 测试1：小程序端

#### 1. 重新编译

点击微信开发者工具顶部的 **"编译"** 按钮

#### 2. 打开控制台

点击底部的 **"Console"** 标签

#### 3. 查看日志

应该看到：
```
✅ 云开发初始化成功，环境ID: cloud-xxxxx
```

如果看到这个，说明配置成功！✅

如果看到：
```
⚠️ 未配置云开发环境ID，使用本地存储模式
```

说明环境ID配置有误，请检查 `app.js` 第5行。

---

### 测试2：Web管理后台

#### 1. 打开后台

用浏览器打开：

```
文件路径/admin/index.html
```

#### 2. 登录

```
用户名：admin
密码：admin123
```

#### 3. 进入摄影师管理

点击左侧菜单 **"摄影师管理"**

#### 4. 添加测试摄影师

点击 **"添加摄影师"** 按钮，填写信息，保存。

#### 5. 验证数据同步

**刷新页面**，看摄影师是否还在。

如果还在，说明数据已保存到云端！✅

#### 6. 在小程序端验证

回到微信开发者工具，进入小程序的 **"申请入学"** → **"选择摄影师"**

应该能看到刚才在Web后台添加的摄影师！

如果能看到，说明**数据同步成功**！🎉

---

## 🎉 完成！

恭喜您！云开发配置完成！

现在您的系统：
- ✅ 数据永久保存，不会丢失
- ✅ 小程序和Web后台数据实时同步
- ✅ 支持多设备、多管理员使用

---

## ❓ 遇到问题？

### 问题1：找不到"云开发"按钮

**解决**：
1. 确认使用的是微信开发者工具（不是代码编辑器）
2. 确认已打开小程序项目
3. 更新开发者工具到最新版本

### 问题2：环境ID在哪里找？

**解决**：
1. 点击顶部"云开发"按钮
2. 在控制台首页，能看到环境ID
3. 或在"设置"→"环境设置"中查看

### 问题3：云函数上传失败

**解决**：
1. 检查网络连接
2. 确认已开通云开发
3. 尝试切换网络重新上传

### 问题4：HTTP触发器找不到

**解决**：
1. 确认云函数已上传成功
2. 在云函数详情页往下滚动
3. 找到"触发器配置"区域

### 问题5：控制台显示"未配置环境ID"

**解决**：
1. 检查 `app.js` 第5行的环境ID
2. 确保没有 `xxxxx` 这样的占位符
3. 确保环境ID用单引号包裹

---

## 📞 还有问题？

如果按照教程操作还是遇到问题，请：

1. **截图**您当前的界面
2. **复制**控制台的错误信息
3. **告诉我**您卡在哪一步

我会立即帮您解决！🙋‍♂️

---

**配置时间**：约15-20分钟  
**难度**：⭐⭐（零基础可操作）  
**效果**：数据永久保存，多端同步

加油！您一定可以的！💪

