# 📸 生活照系统说明

## 一、系统概述

生活照系统支持用户上传最多4张生活照，证件照完成后自动添加为第5张（锁定不可删除）。

## 二、功能特点

### 1. 入学申请时
- **可上传数量**：最多4张生活照
- **上传方式**：网格布局，支持批量选择
- **显示方式**：3列网格，1:1比例
- **操作**：可预览、可删除

### 2. 证件照完成后
- **自动添加**：证件照自动添加到生活照数组末尾（第5张）
- **锁定状态**：证件照不可删除（由 `certificatePhoto` 字段标识）
- **用途**：
  - 作为学生头像（avatar）
  - 作为生活照的一部分
  - 摄影师可下载用于绘画参考

### 3. 摄影师视角
- **可下载**：所有生活照（4张）+ 证件照（1张）
- **用途**：作为绘画参考素材

### 4. 用户编辑（未来功能）
- **可编辑**：前4张生活照可以更换
- **不可编辑**：第5张证件照锁定，不可删除
- **入口**：个人档案 → 编辑生活照

## 三、数据结构

### students 表
```javascript
{
  studentId: "20250001",
  name: "张三",
  avatar: "cloud://certificate.jpg", // 证件照（头像）
  lifePhotos: [
    "cloud://life1.jpg",  // 生活照1
    "cloud://life2.jpg",  // 生活照2
    "cloud://life3.jpg",  // 生活照3
    "cloud://life4.jpg",  // 生活照4
    "cloud://certificate.jpg"  // 证件照（第5张，锁定）
  ],
  certificatePhoto: "cloud://certificate.jpg", // 单独保存，用于标识锁定
  // ... 其他字段
}
```

### activity_orders 表
```javascript
{
  studentName: "张三",
  lifePhotos: [
    "cloud://life1.jpg",
    "cloud://life2.jpg",
    "cloud://life3.jpg",
    "cloud://life4.jpg"
  ],
  photos: [
    "cloud://certificate.jpg"  // 证件照（摄影师上传）
  ],
  // ... 其他字段
}
```

## 四、实现逻辑

### 入学申请流程
```javascript
1. 用户填写表单
   ├─ 上传生活照（最多4张）
   └─ 填写其他信息

2. 预览档案
   ├─ 显示所有生活照（网格布局）
   └─ 显示其他信息

3. 选择摄影师并支付

4. 创建订单
   └─ lifePhotos: [life1, life2, life3, life4]
```

### 证件照完成流程
```javascript
1. 摄影师上传证件照
   └─ photos: [certificate.jpg]

2. 用户确认满意

3. 系统自动创建学生档案
   ├─ 合并生活照和证件照
   │   lifePhotos: [life1, life2, life3, life4, certificate]
   ├─ 设置头像
   │   avatar: certificate
   └─ 保存证件照标识
       certificatePhoto: certificate
```

### 摄影师下载流程
```javascript
1. 摄影师查看订单详情

2. 下载所有照片
   ├─ 生活照：order.lifePhotos (4张)
   └─ 证件照：order.photos[0] (1张)

3. 用于绘画参考
```

## 五、界面设计

### 入学申请页面
```
┌─────────────────────────────────┐
│  生活照片 *                      │
│  上传孩子的生活照，最多4张        │
│  （证件照完成后会自动添加为第5张） │
│                                  │
│  ┌────┐ ┌────┐ ┌────┐           │
│  │ 📷 │ │ 📷 │ │ + │            │
│  │    │ │    │ │ 上传│            │
│  │ ×  │ │ ×  │ │ 2/4│            │
│  └────┘ └────┘ └────┘           │
└─────────────────────────────────┘
```

### 档案预览页面
```
┌─────────────────────────────────┐
│  生活照片 (4张)                  │
│                                  │
│  ┌────┐ ┌────┐ ┌────┐           │
│  │ 📷 │ │ 📷 │ │ 📷 │           │
│  │    │ │    │ │    │           │
│  └────┘ └────┘ └────┘           │
│                                  │
│  ┌────┐                          │
│  │ 📷 │                          │
│  │    │                          │
│  └────┘                          │
└─────────────────────────────────┘
```

### 学生档案页面（未来）
```
┌─────────────────────────────────┐
│  生活照片 (5张)          [编辑]  │
│                                  │
│  ┌────┐ ┌────┐ ┌────┐           │
│  │ 📷 │ │ 📷 │ │ 📷 │           │
│  │ ×  │ │ ×  │ │ ×  │           │
│  └────┘ └────┘ └────┘           │
│                                  │
│  ┌────┐ ┌────┐                  │
│  │ 📷 │ │ 📷 │                  │
│  │ ×  │ │ 🔒 │ ← 证件照（锁定） │
│  └────┘ └────┘                  │
└─────────────────────────────────┘
```

## 六、样式设计

### 网格布局
```css
.photos-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16rpx;
}

.photo-item {
  position: relative;
  padding-bottom: 100%; /* 1:1 */
  border-radius: 16rpx;
  overflow: hidden;
}
```

### 删除按钮
```css
.photo-delete {
  position: absolute;
  top: 8rpx;
  right: 8rpx;
  width: 48rpx;
  height: 48rpx;
  background: rgba(0, 0, 0, 0.6);
  color: white;
  border-radius: 50%;
}
```

### 锁定标识（未来）
```css
.photo-locked {
  position: absolute;
  bottom: 8rpx;
  right: 8rpx;
  background: rgba(0, 0, 0, 0.6);
  color: white;
  padding: 4rpx 12rpx;
  border-radius: 12rpx;
  font-size: 20rpx;
}
```

## 七、未来扩展

### 用户编辑生活照功能
1. 在"我的"页面添加"编辑生活照"入口
2. 显示所有生活照（5张）
3. 前4张可以删除/替换
4. 第5张（证件照）显示锁定图标，不可操作
5. 保存后更新 `students` 表的 `lifePhotos` 字段

### 摄影师下载功能
1. 在订单详情页添加"下载所有照片"按钮
2. 打包下载：
   - 生活照1-4.jpg
   - 证件照.jpg
3. 或单独下载每张照片

### 照片管理功能
1. 管理员可以查看所有学生的生活照
2. 管理员可以帮助学生编辑生活照
3. 管理员可以批量下载照片

## 八、注意事项

1. **证件照唯一性**：`certificatePhoto` 字段用于标识证件照，不可删除
2. **数组顺序**：证件照始终在 `lifePhotos` 数组末尾
3. **头像同步**：`avatar` 字段始终等于 `certificatePhoto`
4. **权限控制**：
   - 用户只能编辑自己孩子的生活照
   - 用户不能删除证件照
   - 摄影师可以查看和下载所有照片
5. **云存储**：所有照片上传到云存储，使用 `cloud://` 路径

---

**版本**: v2.1  
**更新日期**: 2025-10-15  
**功能**: 生活照系统（4+1张，证件照锁定）
