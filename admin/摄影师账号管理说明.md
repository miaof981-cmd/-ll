# 摄影师账号管理说明

## 问题解决

### 问题1：创建摄影师后无法登录 ✅
**原因**：摄影师数据存储在摄影师列表中，登录系统会自动从摄影师列表读取账号信息。

**解决方案**：
- 系统已经支持从摄影师列表中读取登录信息
- 创建摄影师时填写的"登录用户名"和"登录密码"即可用于登录
- 无需手动在 `auth.js` 中添加账号

### 问题2：编辑按钮点不动 ✅
**原因**：可能是数据加载问题或事件绑定问题。

**解决方案**：
- 已添加错误提示：如果摄影师不存在会显示"摄影师不存在"
- 确保摄影师数据正确保存在localStorage中

### 问题3：没有价格字段 ✅
**原因**：之前的设计中确实缺少价格字段。

**解决方案**：
- 已添加"服务价格"字段（必填）
- 价格会显示在摄影师卡片上
- 价格会显示在小程序的摄影师选择页面

---

## 创建摄影师完整流程

### 步骤1：添加摄影师
1. 管理员登录后台
2. 进入"摄影师管理"
3. 点击"+ 添加摄影师"
4. 填写必填信息：
   - **摄影师姓名** *（必填）
   - **服务价格** *（必填，单位：元）
   - **登录用户名** *（必填，用于后台登录）
   - **登录密码**（默认：photo123）
5. 可选信息：
   - 专长风格（如：星空风格、清新自然）
   - 简介
   - 头像
   - 作品样例
6. 点击"保存"

### 步骤2：摄影师登录
1. 打开 `admin/index.html`
2. 选择"摄影师"角色
3. 输入创建时填写的**登录用户名**
4. 输入**登录密码**（默认：photo123）
5. 点击"登录"
6. 自动跳转到摄影师专用工作台

---

## 示例：创建"史依"摄影师

### 填写信息
```
摄影师姓名：史依
专长风格：古风人像
简介：擅长古风、汉服风格的证件照拍摄
服务价格：299
登录用户名：shiyi
登录密码：photo123
```

### 登录步骤
1. 打开登录页面
2. 选择"摄影师"
3. 用户名：`shiyi`
4. 密码：`photo123`
5. 登录成功 ✅

---

## 字段说明

### 摄影师信息字段

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| 摄影师姓名 | 文本 | ✅ | 显示在卡片和小程序中 |
| 专长风格 | 文本 | ❌ | 如：星空风格、清新自然 |
| 简介 | 文本 | ❌ | 摄影师介绍 |
| **服务价格** | 数字 | ✅ | 单位：元，显示在卡片和小程序中 |
| **登录用户名** | 文本 | ✅ | 用于后台登录，不可重复 |
| 登录密码 | 文本 | ❌ | 默认：photo123 |
| 头像 | 图片 | ❌ | 摄影师头像 |
| 作品样例 | 图片 | ❌ | 可上传多张作品 |

---

## 登录账号管理

### 账号存储位置
- 摄影师信息存储在：`localStorage.photographers`
- 登录系统会自动从摄影师列表中读取账号

### 登录验证流程
```
1. 用户输入用户名、密码、选择"摄影师"角色
2. 系统先检查默认账号（admin、service）
3. 如果是摄影师角色，从摄影师列表中查找
4. 匹配 username 和 password
5. 登录成功，跳转到摄影师工作台
```

### 修改密码
1. 进入"摄影师管理"
2. 点击要修改的摄影师的"编辑"按钮
3. 修改"登录密码"字段
4. 保存
5. 下次登录使用新密码

### 删除摄影师
1. 系统会检查是否有进行中的订单
2. 如果有进行中的订单，无法删除
3. 删除后，该摄影师的登录账号也将失效

---

## 价格显示

### 后台管理界面
摄影师卡片会显示：
```
┌─────────────────────┐
│  [头像]  史依        │
│         古风人像     │
├─────────────────────┤
│   服务价格：¥299    │
├─────────────────────┤
│  进行中  已完成  总订单│
│    0      0      0   │
├─────────────────────┤
│  [编辑]    [删除]   │
└─────────────────────┘
```

### 小程序界面
摄影师选择页面会显示：
```
┌─────────────────────┐
│  [头像]             │
│  史依 - 古风人像    │
│  ⭐4.9 📷50作品     │
│                     │
│  作品参考：         │
│  [图1][图2][图3]    │
│                     │
│  拍摄费用：¥299     │
└─────────────────────┘
```

---

## 常见问题

### Q1: 创建摄影师后无法登录？
**A**: 请检查：
1. 是否填写了"登录用户名"
2. 用户名是否输入正确（区分大小写）
3. 密码是否正确（默认：photo123）
4. 是否选择了"摄影师"角色

### Q2: 编辑按钮点击没反应？
**A**: 请检查：
1. 浏览器控制台是否有错误
2. 刷新页面后重试
3. 清除浏览器缓存

### Q3: 价格显示为空？
**A**: 
- 旧数据可能没有价格字段
- 需要编辑摄影师，填写价格后保存

### Q4: 可以修改用户名吗？
**A**: 
- 可以修改
- 修改后需要使用新用户名登录

### Q5: 忘记密码怎么办？
**A**: 
- 管理员可以在"摄影师管理"中编辑摄影师
- 查看或修改"登录密码"字段
- 或重置为默认密码：photo123

---

## 测试步骤

### 完整测试流程

1. **创建摄影师**
   ```
   姓名：测试摄影师
   价格：199
   用户名：test_photo
   密码：photo123
   ```

2. **保存并查看**
   - ✅ 摄影师卡片显示价格：¥199
   - ✅ 摄影师列表中可以看到新摄影师

3. **测试登录**
   - 打开登录页面
   - 选择"摄影师"
   - 用户名：test_photo
   - 密码：photo123
   - ✅ 登录成功，跳转到工作台

4. **测试编辑**
   - 点击"编辑"按钮
   - ✅ 弹出编辑框
   - ✅ 所有信息正确显示
   - 修改价格为 299
   - 保存
   - ✅ 价格更新为 ¥299

5. **测试删除**
   - 点击"删除"按钮
   - ✅ 弹出确认框
   - 确认删除
   - ✅ 摄影师已删除
   - 尝试登录
   - ✅ 登录失败（账号已失效）

---

## 技术实现

### 登录验证代码
```javascript
// admin/js/auth.js
login(username, password, role) {
  // 检查摄影师账号
  if (role === 'photographer') {
    const photographers = Storage.getPhotographers();
    const photographer = photographers.find(p => 
      p.username === username && p.password === password
    );
    
    if (photographer) {
      const user = {
        username: photographer.username || photographer.name,
        name: photographer.name,
        role: 'photographer',
        photographerId: photographer.id,
        loginTime: new Date().toISOString()
      };
      Storage.set('currentUser', user);
      return { success: true, user };
    }
  }
  
  return { success: false, message: '用户名或密码错误' };
}
```

### 保存摄影师代码
```javascript
// admin/js/photographers.js
function savePhotographer() {
  const photographerData = {
    name: '史依',
    specialty: '古风人像',
    description: '擅长古风、汉服风格的证件照拍摄',
    price: 299,  // 新增价格字段
    username: 'shiyi',  // 登录用户名
    password: 'photo123',  // 登录密码
    avatar: avatarData,
    samples: samplesData,
    status: 'available'
  };
  
  Storage.savePhotographer(photographerData);
}
```

---

**更新时间**：2025-10-13  
**版本**：v2.1  
**状态**：✅ 已完成

