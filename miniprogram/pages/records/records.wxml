<!--pages/records/records.wxml-->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯ -->
  <view class="user-info" wx:if="{{userInfo}}">
    <view class="user-avatar">ğŸ‘¤</view>
    <view class="user-details">
      <view class="user-name">{{userInfo.name}}</view>
      <view class="user-id">å­¦å·ï¼š{{userInfo.studentId}}</view>
    </view>
    <button class="logout-btn" bindtap="logout" size="mini">é€€å‡º</button>
  </view>

  <!-- æ ‡ç­¾é¡µ -->
  <view class="tabs">
    <view 
      class="tab-item {{activeTab === 'grades' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="grades"
    >
      ğŸ“Š æˆç»©å•
    </view>
    <view 
      class="tab-item {{activeTab === 'punishments' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="punishments"
    >
      âš ï¸ å¤„åˆ†è®°å½•
    </view>
    <view 
      class="tab-item {{activeTab === 'images' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="images"
    >
      ğŸ–¼ï¸ å›¾ç‰‡æ¡£æ¡ˆ
    </view>
  </view>

  <!-- æˆç»©å• -->
  <view class="tab-content" wx:if="{{activeTab === 'grades'}}">
    <view wx:if="{{records.reportCards.length === 0}}" class="empty-state">
      <view class="empty-state-icon">ğŸ“Š</view>
      <view class="empty-state-text">æš‚æ— æˆç»©è®°å½•</view>
    </view>

    <view wx:for="{{records.reportCards}}" wx:key="term" class="grade-card">
      <view class="grade-header">
        <text class="grade-term">{{item.term}}</text>
        <text class="grade-average">å¹³å‡åˆ†ï¼š{{item.average || 'è®¡ç®—ä¸­'}}</text>
      </view>
      <view class="grade-subjects">
        <view class="subject-item">
          <text class="subject-name">è¯­æ–‡</text>
          <text class="subject-score">{{item.chinese}}</text>
        </view>
        <view class="subject-item">
          <text class="subject-name">æ•°å­¦</text>
          <text class="subject-score">{{item.math}}</text>
        </view>
        <view class="subject-item">
          <text class="subject-name">è‹±è¯­</text>
          <text class="subject-score">{{item.english}}</text>
        </view>
        <view class="subject-item">
          <text class="subject-name">ç‰©ç†</text>
          <text class="subject-score">{{item.physics}}</text>
        </view>
        <view class="subject-item">
          <text class="subject-name">åŒ–å­¦</text>
          <text class="subject-score">{{item.chemistry}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¤„åˆ†è®°å½• -->
  <view class="tab-content" wx:if="{{activeTab === 'punishments'}}">
    <view wx:if="{{records.punishments.length === 0}}" class="empty-state">
      <view class="empty-state-icon">âœ…</view>
      <view class="empty-state-text">æ— å¤„åˆ†è®°å½•ï¼Œè¡¨ç°è‰¯å¥½ï¼</view>
    </view>

    <view wx:for="{{records.punishments}}" wx:key="index" class="punishment-card">
      <view class="punishment-header">
        <text class="punishment-type tag tag-warning">{{item.type}}</text>
        <text class="punishment-date">{{item.date}}</text>
      </view>
      <view class="punishment-reason">{{item.reason}}</view>
    </view>
  </view>

  <!-- å›¾ç‰‡æ¡£æ¡ˆ -->
  <view class="tab-content" wx:if="{{activeTab === 'images'}}">
    <view wx:if="{{records.images.length === 0}}" class="empty-state">
      <view class="empty-state-icon">ğŸ–¼ï¸</view>
      <view class="empty-state-text">æš‚æ— å›¾ç‰‡æ¡£æ¡ˆ</view>
    </view>

    <view class="images-grid">
      <view wx:for="{{records.images}}" wx:key="id" class="image-card" bindtap="previewImage" data-url="{{item.url}}">
        <image class="image-thumbnail" src="{{item.url}}" mode="aspectFill"></image>
        <view class="image-info">
          <view class="image-title">{{item.title}}</view>
          <view class="image-desc">{{item.description}}</view>
          <view class="image-date">{{item.uploadedAt}}</view>
        </view>
      </view>
    </view>
  </view>
</view>
