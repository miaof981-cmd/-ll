<!--pages/records/records.wxml-->
<view class="records-container">
  <!-- é¡¶éƒ¨ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-profile-card">
    <view class="profile-avatar">
      <text class="avatar-icon">ğŸ‘¤</text>
    </view>
    <view class="profile-info">
      <text class="profile-name">{{userInfo.name}}</text>
      <text class="profile-id">å­¦å·ï¼š{{userInfo.studentId}}</text>
    </view>
    <view class="profile-action" bindtap="logout">
      <text class="action-text">é€€å‡º</text>
    </view>
  </view>

  <!-- æ¡£æ¡ˆæ ‡é¢˜ -->
  <view class="section-title-bar">
    <text class="section-icon">ğŸ“š</text>
    <text class="section-title">å­¦ç”Ÿæ¡£æ¡ˆ</text>
  </view>

  <!-- ç€‘å¸ƒæµæ¡£æ¡ˆå¡ç‰‡ -->
  <view wx:if="{{!loading}}" class="waterfall-container">
    <!-- æˆç»©å¡ç‰‡ -->
    <view 
      wx:for="{{records.reportCards}}" 
      wx:key="term" 
      class="archive-card grade-card"
    >
      <view class="card-header">
        <view class="card-icon">ğŸ“Š</view>
        <text class="card-type">æˆç»©æŠ¥å‘Š</text>
      </view>
      <view class="card-body">
        <text class="card-title">{{item.term}}</text>
        <view class="grade-grid">
          <view class="grade-item">
            <text class="subject">è¯­æ–‡</text>
            <text class="score">{{item.chinese}}</text>
          </view>
          <view class="grade-item">
            <text class="subject">æ•°å­¦</text>
            <text class="score">{{item.math}}</text>
          </view>
          <view class="grade-item">
            <text class="subject">è‹±è¯­</text>
            <text class="score">{{item.english}}</text>
          </view>
          <view class="grade-item">
            <text class="subject">ç‰©ç†</text>
            <text class="score">{{item.physics}}</text>
          </view>
          <view class="grade-item">
            <text class="subject">åŒ–å­¦</text>
            <text class="score">{{item.chemistry}}</text>
          </view>
        </view>
      </view>
      <view class="card-footer">
        <view class="average-badge">
          <text>å¹³å‡åˆ†ï¼š{{item.average}}</text>
        </view>
      </view>
    </view>

    <!-- å¤„ç½šè®°å½•å¡ç‰‡ -->
    <view 
      wx:for="{{records.punishments}}" 
      wx:key="date" 
      class="archive-card punishment-card"
    >
      <view class="card-header">
        <view class="card-icon warning">âš ï¸</view>
        <text class="card-type">å¤„ç½šè®°å½•</text>
      </view>
      <view class="card-body">
        <view class="punishment-type">
          <text class="type-label">ç±»å‹ï¼š</text>
          <text class="type-value">{{item.type}}</text>
        </view>
        <text class="punishment-reason">{{item.reason}}</text>
      </view>
      <view class="card-footer">
        <text class="card-date">ğŸ“… {{item.date}}</text>
      </view>
    </view>

    <!-- å›¾ç‰‡æ¡£æ¡ˆå¡ç‰‡ -->
    <view 
      wx:for="{{records.images}}" 
      wx:key="id" 
      class="archive-card image-card"
      bindtap="previewImage"
      data-url="{{item.url}}"
    >
      <view class="card-header">
        <view class="card-icon">ğŸ–¼ï¸</view>
        <text class="card-type">å›¾ç‰‡æ¡£æ¡ˆ</text>
      </view>
      <image class="card-image" src="{{item.url}}" mode="widthFix" />
      <view class="card-body">
        <text class="card-title">{{item.title}}</text>
        <text class="card-desc">{{item.description}}</text>
      </view>
      <view class="card-footer">
        <text class="card-date">ğŸ“… {{item.uploadedAt}}</text>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{records.reportCards.length === 0 && records.punishments.length === 0 && records.images.length === 0}}" class="empty-state">
      <view class="empty-icon">ğŸ“‹</view>
      <text class="empty-text">æš‚æ— æ¡£æ¡ˆè®°å½•</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-wrapper">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</view>
