<!--pages/admin/activities/activities.wxml-->
<view class="activities-admin-page">
  <!-- é¡¶éƒ¨æ“ä½œæ  -->
  <view class="top-bar">
    <view class="filter-tabs">
      <view 
        class="filter-tab {{statusFilter === 'all' ? 'active' : ''}}" 
        bindtap="filterStatus" 
        data-status="all"
      >
        å…¨éƒ¨
      </view>
      <view 
        class="filter-tab {{statusFilter === 'active' ? 'active' : ''}}" 
        bindtap="filterStatus" 
        data-status="active"
      >
        å·²ä¸Šæ¶
      </view>
      <view 
        class="filter-tab {{statusFilter === 'inactive' ? 'active' : ''}}" 
        bindtap="filterStatus" 
        data-status="inactive"
      >
        å·²ä¸‹æ¶
      </view>
    </view>
    <button class="btn-create" bindtap="createActivity">+ åˆ›å»ºæ´»åŠ¨</button>
  </view>

  <!-- æ´»åŠ¨åˆ—è¡¨ -->
  <view wx:if="{{!loading && activities.length === 0}}" class="empty-state">
    <view class="empty-icon">ğŸ¨</view>
    <text class="empty-text">æš‚æ— æ´»åŠ¨</text>
    <button class="btn-create-empty" bindtap="createActivity">åˆ›å»ºç¬¬ä¸€ä¸ªæ´»åŠ¨</button>
  </view>

  <view wx:if="{{!loading}}" class="activity-list">
    <view 
      wx:for="{{activities}}" 
      wx:key="_id" 
      class="activity-item {{item.status === 'active' ? 'active' : 'inactive'}}"
    >
      <!-- æ´»åŠ¨å°é¢ -->
      <image class="activity-cover" src="{{item.coverImage}}" mode="aspectFill" bindtap="viewActivity" data-id="{{item._id}}" />
      
      <!-- æ´»åŠ¨ä¿¡æ¯ -->
      <view class="activity-info">
        <view class="info-header">
          <view class="title-row">
            <text class="activity-title">{{item.title}}</text>
            <view class="status-badge {{item.status}}">
              {{item.status === 'active' ? 'å·²ä¸Šæ¶' : 'å·²ä¸‹æ¶'}}
            </view>
          </view>
          <text class="activity-subtitle">{{item.subtitle}}</text>
        </view>

        <view class="info-details">
          <view class="detail-item">
            <text class="label">åˆ†ç±»ï¼š</text>
            <text class="value">{{item.category}}</text>
          </view>
          <view class="detail-item">
            <text class="label">ä»·æ ¼ï¼š</text>
            <text class="value price">Â¥{{item.price}}</text>
          </view>
          <view class="detail-item">
            <text class="label">æµè§ˆï¼š</text>
            <text class="value">{{item.viewCount || 0}}</text>
          </view>
          <view class="detail-item">
            <text class="label">è®¢å•ï¼š</text>
            <text class="value">{{item.orderCount || 0}}</text>
          </view>
        </view>

        <view class="info-tags">
          <view wx:if="{{item.isHot}}" class="tag tag-hot">ğŸ”¥ çƒ­é—¨</view>
          <view wx:if="{{item.isNew}}" class="tag tag-new">ğŸ†• æ–°å“</view>
          <view wx:if="{{item.isDefault}}" class="tag tag-default">â­ é»˜è®¤æ´»åŠ¨</view>
          <view wx:if="{{item.category === 'è¯ä»¶ç…§'}}" class="tag tag-special">ğŸ“¸ è¯ä»¶ç…§</view>
        </view>

        <view class="action-buttons">
          <button class="btn-action btn-edit" bindtap="editActivity" data-id="{{item._id}}">
            ç¼–è¾‘
          </button>
          <button 
            class="btn-action btn-toggle" 
            bindtap="toggleStatus" 
            data-id="{{item._id}}" 
            data-status="{{item.status}}"
            data-title="{{item.title}}"
          >
            {{item.status === 'active' ? 'ä¸‹æ¶' : 'ä¸Šæ¶'}}
          </button>
          <button 
            class="btn-action {{item.isDefault ? 'btn-disabled' : 'btn-delete'}}" 
            bindtap="deleteActivity" 
            data-id="{{item._id}}"
            data-title="{{item.title}}"
            data-isdefault="{{item.isDefault}}"
            disabled="{{item.isDefault}}"
          >
            {{item.isDefault ? 'ä¸å¯åˆ é™¤' : 'åˆ é™¤'}}
          </button>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-wrapper">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</view>

