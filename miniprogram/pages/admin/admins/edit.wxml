<!--pages/admin/admins/edit.wxml-->
<view class="edit-page">
  <view class="form-container">
    
    <!-- OpenID（仅添加时显示） -->
    <view wx:if="{{mode === 'add'}}" class="form-section">
      <view class="section-header">
        <text class="section-title">OpenID</text>
        <text class="help-btn" bindtap="showOpenidHelp">❓</text>
      </view>
      <input 
        class="form-input"
        type="text"
        placeholder="请输入用户的微信OpenID"
        value="{{formData.openid}}"
        bindinput="onOpenidInput"
      />
      <view class="field-tip">
        提示：让用户先登录小程序，在"我的"页面可以查看和复制OpenID
      </view>
    </view>

    <!-- 显示当前 OpenID（编辑时） -->
    <view wx:if="{{mode === 'edit'}}" class="form-section">
      <text class="section-title">OpenID</text>
      <view class="readonly-field">{{formData.openid}}</view>
      <view class="field-tip">OpenID 不可修改</view>
    </view>

    <!-- 姓名 -->
    <view class="form-section">
      <text class="section-title required">姓名</text>
      <input 
        class="form-input"
        type="text"
        placeholder="请输入管理员姓名"
        value="{{formData.name}}"
        bindinput="onNameInput"
      />
    </view>

    <!-- 手机号 -->
    <view class="form-section">
      <text class="section-title">手机号</text>
      <input 
        class="form-input"
        type="number"
        placeholder="请输入手机号（可选）"
        value="{{formData.phone}}"
        bindinput="onPhoneInput"
      />
    </view>

    <!-- 权限配置 -->
    <view class="form-section">
      <text class="section-title required">权限配置</text>
      <checkbox-group bindchange="onPermissionChange">
        <label 
          wx:for="{{permissionOptions}}" 
          wx:key="value"
          class="permission-item"
        >
          <checkbox value="{{item.value}}" checked="{{item.checked}}" />
          <text class="permission-label">{{item.label}}</text>
        </label>
      </checkbox-group>
      <view class="field-tip">
        选择"所有权限"将拥有系统全部管理功能
      </view>
    </view>

    <!-- 启用状态 -->
    <view class="form-section">
      <view class="switch-row">
        <text class="section-title">启用状态</text>
        <switch 
          checked="{{formData.isActive}}" 
          bindchange="onStatusChange"
          color="#667eea"
        />
      </view>
      <view class="field-tip">
        禁用后该管理员将无法登录管理后台
      </view>
    </view>

    <!-- 保存按钮 -->
    <view class="button-group">
      <button class="save-btn" bindtap="saveAdmin">
        {{mode === 'add' ? '添加管理员' : '保存修改'}}
      </button>
    </view>
  </view>

  <!-- OpenID 帮助弹窗 -->
  <view wx:if="{{showOpenidTip}}" class="modal-mask" bindtap="hideOpenidTip">
    <view class="modal-content" catchtap>
      <view class="modal-header">
        <text class="modal-title">如何获取 OpenID？</text>
        <text class="modal-close" bindtap="hideOpenidTip">✕</text>
      </view>
      <view class="modal-body">
        <view class="step-item">
          <text class="step-num">1</text>
          <text class="step-text">让用户先使用微信登录小程序</text>
        </view>
        <view class="step-item">
          <text class="step-num">2</text>
          <text class="step-text">用户进入"我的"页面</text>
        </view>
        <view class="step-item">
          <text class="step-num">3</text>
          <text class="step-text">在用户卡片中可以看到并复制 OpenID</text>
        </view>
        <view class="step-item">
          <text class="step-num">4</text>
          <text class="step-text">将复制的 OpenID 粘贴到这里</text>
        </view>
      </view>
      <button class="modal-btn" bindtap="hideOpenidTip">我知道了</button>
    </view>
  </view>
</view>

