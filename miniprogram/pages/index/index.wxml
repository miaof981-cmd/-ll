<!--pages/index/index.wxml-->
<view class="page-container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="header">
    <view class="header-content">
      <view class="logo-section">
        <text class="logo-icon">ğŸ“</text>
        <text class="logo-text">å­¦æ ¡å®˜ç½‘</text>
      </view>
    </view>
  </view>

  <!-- ä¸»å†…å®¹åŒº -->
  <view class="main-content">
    <!-- è½®æ’­å›¾åŒºåŸŸ - è‡ªé€‚åº”é«˜åº¦ -->
    <view wx:if="{{banners.length > 0}}" class="banner-section">
      <swiper 
        class="banner-swiper" 
        style="height: {{bannerHeight}}px"
        autoplay="{{true}}" 
        interval="3000" 
        duration="500" 
        circular="{{true}}"
        bindchange="onBannerChange"
      >
        <swiper-item wx:for="{{banners}}" wx:key="id">
          <image 
            class="banner-image" 
            src="{{item.imageUrl}}" 
            mode="widthFix"
            bindload="onBannerImageLoad"
            data-index="{{index}}"
          />
        </swiper-item>
      </swiper>
    </view>

    <!-- å­¦æ ¡å…¬å‘ŠåŒº -->
    <view class="content-section">
      <view class="section-header">
        <view class="section-title-wrapper">
          <view class="section-icon">ğŸ“¢</view>
          <text class="section-title">å­¦æ ¡å…¬å‘Š</text>
        </view>
      </view>

      <view wx:if="{{announcements.length === 0}}" class="empty-state">
        <view class="empty-icon">ğŸ“</view>
        <text class="empty-text">æš‚æ— å…¬å‘Š</text>
      </view>

      <view class="announcement-list">
        <view 
          wx:for="{{announcements}}" 
          wx:key="id" 
          class="announcement-card fade-in"
          style="animation-delay: {{index * 0.1}}s"
          bindtap="viewAnnouncement" 
          data-announcement="{{item}}"
        >
          <!-- å…¬å‘Šå°é¢å›¾ -->
          <image 
            wx:if="{{item.coverImage}}" 
            class="announcement-cover" 
            src="{{item.coverImage}}" 
            mode="widthFix"
          />
          
          <view class="announcement-body">
            <view class="announcement-header">
              <text class="announcement-title">{{item.title}}</text>
              <view wx:if="{{item.pinned}}" class="tag tag-danger">ç½®é¡¶</view>
            </view>
            <view class="announcement-content">{{item.content}}</view>
            <view class="announcement-footer">
              <text class="announcement-time">ğŸ“… {{item.createdAt}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- æ´»åŠ¨å±•ç¤ºåŒº -->
    <view class="content-section">
      <view class="section-header">
        <view class="section-title-wrapper">
          <view class="section-icon">ğŸ¯</view>
          <text class="section-title">å…¨éƒ¨æ´»åŠ¨</text>
        </view>
      </view>

      <!-- åˆ†ç±»ç­›é€‰ -->
      <scroll-view class="category-tabs" scroll-x="true" enable-flex="true">
        <view 
          wx:for="{{categories}}" 
          wx:key="id" 
          class="category-tab {{activeCategory === item.id ? 'active' : ''}}"
          bindtap="switchCategory"
          data-category="{{item.id}}"
        >
          {{item.name}}
        </view>
      </scroll-view>

      <!-- æ´»åŠ¨åˆ—è¡¨ -->
      <view wx:if="{{activities.length === 0}}" class="empty-state">
        <view class="empty-icon">ğŸ¨</view>
        <text class="empty-text">æš‚æ— æ´»åŠ¨</text>
      </view>

      <view class="activity-grid">
        <view 
          wx:for="{{activities}}" 
          wx:key="_id" 
          class="activity-card fade-in"
          style="animation-delay: {{index * 0.1}}s"
          bindtap="viewActivity"
          data-id="{{item._id}}"
        >
          <!-- æ´»åŠ¨å°é¢ -->
          <view class="activity-cover-wrap">
            <image class="activity-cover" src="{{item.coverImage}}" mode="aspectFill" />
            <!-- æ ‡ç­¾ -->
            <view class="activity-badges">
              <view wx:if="{{item.isHot}}" class="badge badge-hot">ğŸ”¥ çƒ­é—¨</view>
              <view wx:if="{{item.isNew}}" class="badge badge-new">ğŸ†• æ–°å“</view>
            </view>
          </view>

          <!-- æ´»åŠ¨ä¿¡æ¯ -->
          <view class="activity-info">
            <text class="activity-title">{{item.title}}</text>
            <text class="activity-subtitle">{{item.subtitle}}</text>
            
            <view class="activity-footer">
              <view class="activity-price">
                <text class="price-current">Â¥{{item.price}}</text>
                <text wx:if="{{item.originalPrice > item.price}}" class="price-original">Â¥{{item.originalPrice}}</text>
              </view>
              <view class="activity-stats">
                <text class="stat-item">ğŸ‘ {{item.viewCount || 0}}</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
