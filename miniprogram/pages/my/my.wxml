<!--pages/my/my.wxml-->
<view class="container">
  <!-- æœªç™»å½•æç¤º -->
  <view wx:if="{{!userInfo}}" class="login-tip">
    <view class="tip-title">è¯·å…ˆç™»å½•</view>
    <view class="tip-desc">ç™»å½•åå¯æŸ¥çœ‹ä¸ªäººæ¡£æ¡ˆ</view>
    <navigator url="/pages/login/login" class="login-btn">å»ç™»å½•</navigator>
  </view>

  <!-- å·²ç™»å½•ï¼šä¸ªäººä¿¡æ¯ + ç®¡ç†æˆ–æ¡£æ¡ˆ -->
  <view wx:if="{{userInfo}}">
    <!-- ä¸ªäººä¿¡æ¯ -->
    <view class="profile">
      <view class="avatar">ğŸ‘¤</view>
      <view class="info">
        <view class="name">{{userInfo.name}}</view>
        <view class="id">å­¦å·ï¼š{{userInfo.studentId}}</view>
      </view>
      <button class="logout" size="mini" bindtap="logout">é€€å‡º</button>
    </view>

    <!-- ç®¡ç†å‘˜ï¼šç›´æ¥å±•ç¤ºç®¡ç†åå°å…¥å£å¡ç‰‡ï¼ˆå½’å±â€œæˆ‘çš„â€é¡µï¼Œä¸å†å•ç‹¬æŒ‰é’®é¡µï¼‰ -->
    <view wx:if="{{isAdmin}}" class="admin-actions">
      <view class="actions-grid">
        <button class="action-card primary" bindtap="goAdmin">è¿›å…¥ç®¡ç†åå°</button>
      </view>
    </view>

    <!-- éç®¡ç†å‘˜ï¼šæ¡£æ¡ˆç€‘å¸ƒæµ -->
    <view wx:if="{{!isAdmin}}" class="waterfall">
      <view class="column">
        <block wx:for="{{leftColumn}}" wx:key="_id">
          <view class="card" bindtap="openRecord" data-record="{{item}}">
            <view class="card-tag success" wx:if="{{item.type === 'grade'}}">æˆç»©</view>
            <view class="card-tag warn" wx:if="{{item.type === 'punishment'}}">å¤„åˆ†</view>
            <image wx:if="{{item.type === 'image' && item.url}}" class="card-image" src="{{item.url}}" mode="widthFix" />
            <view class="card-title">{{item.title}}</view>
            <view class="card-content">{{item.content}}</view>
            <view class="card-meta">{{item.date}}</view>
          </view>
        </block>
      </view>
      <view class="column">
        <block wx:for="{{rightColumn}}" wx:key="_id">
          <view class="card" bindtap="openRecord" data-record="{{item}}">
            <view class="card-tag success" wx:if="{{item.type === 'grade'}}">æˆç»©</view>
            <view class="card-tag warn" wx:if="{{item.type === 'punishment'}}">å¤„åˆ†</view>
            <image wx:if="{{item.type === 'image' && item.url}}" class="card-image" src="{{item.url}}" mode="widthFix" />
            <view class="card-title">{{item.title}}</view>
            <view class="card-content">{{item.content}}</view>
            <view class="card-meta">{{item.date}}</view>
          </view>
        </block>
      </view>
    </view>
  </view>
</view>

