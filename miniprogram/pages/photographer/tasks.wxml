<!--pages/photographer/tasks.wxml-->
<view class="container">
  <!-- æ‘„å½±å¸ˆä¿¡æ¯å¡ç‰‡ -->
  <view wx:if="{{photographerInfo}}" class="photographer-card">
    <image class="avatar" src="{{photographerInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
    <view class="info">
      <text class="name">{{photographerInfo.name}}</text>
      <text class="specialty">{{photographerInfo.specialty || 'ä¸“ä¸šæ‘„å½±å¸ˆ'}}</text>
    </view>
  </view>

  <!-- ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-container">
    <view class="stat-item urgent">
      <text class="stat-value">{{stats.notUploaded}}</text>
      <text class="stat-label">å¾…ä¸Šä¼ </text>
    </view>
    <view class="stat-item">
      <text class="stat-value processing">{{stats.uploaded}}</text>
      <text class="stat-label">å¾…ç¡®è®¤</text>
    </view>
    <view class="stat-item">
      <text class="stat-value completed">{{stats.confirmed}}</text>
      <text class="stat-label">å·²å®Œæˆ</text>
    </view>
    <view class="stat-item">
      <text class="stat-value">{{stats.total}}</text>
      <text class="stat-label">æ€»è®¢å•</text>
    </view>
  </view>

  <!-- çŠ¶æ€ç­›é€‰ -->
  <view class="filter-tabs">
    <view 
      class="filter-tab {{statusFilter === 'all' ? 'active' : ''}}" 
      bindtap="onStatusFilterChange" 
      data-status="all"
    >
      å…¨éƒ¨è®¢å•
    </view>
    <view 
      class="filter-tab {{statusFilter === 'not_uploaded' ? 'active' : ''}}" 
      bindtap="onStatusFilterChange" 
      data-status="not_uploaded"
    >
      ğŸ”¥ å¾…ä¸Šä¼ 
    </view>
    <view 
      class="filter-tab {{statusFilter === 'uploaded' ? 'active' : ''}}" 
      bindtap="onStatusFilterChange" 
      data-status="uploaded"
    >
      â³ å¾…ç¡®è®¤
    </view>
    <view 
      class="filter-tab {{statusFilter === 'confirmed' ? 'active' : ''}}" 
      bindtap="onStatusFilterChange" 
      data-status="confirmed"
    >
      âœ… å·²å®Œæˆ
    </view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="orders-container">
    <view wx:if="{{loading}}" class="loading">
      <text>åŠ è½½ä¸­...</text>
    </view>

    <view wx:elif="{{orders.length === 0}}" class="empty">
      <text class="empty-icon">ğŸ“¦</text>
      <text class="empty-text">æš‚æ— è®¢å•</text>
    </view>

    <view wx:else class="orders-list">
      <view 
        wx:for="{{orders}}" 
        wx:key="_id" 
        class="order-card {{item.isUrgent ? 'urgent' : ''}}"
        bindtap="viewOrderDetail"
        data-id="{{item._id}}"
      >
        <!-- ç´§æ€¥æ ‡ç­¾ -->
        <view wx:if="{{item.isUrgent && !item.hasPhotos}}" class="urgent-tag">
          <text>ğŸ”¥ ç´§æ€¥</text>
        </view>

        <!-- è®¢å•å¤´éƒ¨ -->
        <view class="order-header">
          <view class="header-left">
            <text class="student-name">{{item.studentName}}</text>
            <text class="activity-name">{{item.activityName || 'è¯ä»¶ç…§æ‹æ‘„'}}</text>
          </view>
          <view class="header-right">
            <text class="time-text">{{item.timeText}}</text>
          </view>
        </view>

        <!-- è®¢å•çŠ¶æ€ -->
        <view class="order-status-row">
          <view class="status-item">
            <text class="status-icon">ğŸ“·</text>
            <text class="status-text">
              {{item.hasPhotos ? 'å·²ä¸Šä¼  ' + item.photoCount + ' å¼ ' : 'æœªä¸Šä¼ ä½œå“'}}
            </text>
          </view>
          <view class="status-item" wx:if="{{item.status === 'pending_confirm'}}">
            <text class="status-icon">â³</text>
            <text class="status-text">ç­‰å¾…ç¡®è®¤</text>
          </view>
          <view class="status-item success" wx:if="{{item.status === 'completed'}}">
            <text class="status-icon">âœ…</text>
            <text class="status-text">å·²å®Œæˆ</text>
          </view>
        </view>

        <!-- å¿«æ·æ“ä½œ -->
        <view class="quick-actions">
          <view class="action-hint">
            <text wx:if="{{!item.hasPhotos}}">ç‚¹å‡»è¿›å…¥ä¸Šä¼ ä½œå“ â†’</text>
            <text wx:elif="{{item.status === 'pending_confirm'}}">ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ… â†’</text>
            <text wx:else>ç‚¹å‡»æŸ¥çœ‹è®¢å• â†’</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åˆ·æ–°æŒ‰é’® -->
  <view class="refresh-btn" bindtap="onRefresh">
    <text>ğŸ”„ åˆ·æ–°</text>
  </view>
</view>

