<view class="order-detail-page">
  <view wx:if="{{loading}}" class="loading">加载中...</view>

  <view wx:else class="order-container">
    <!-- 订单状态 -->
    <view class="status-card">
      <view class="status-icon" style="color: {{order.statusColor}}">{{order.statusIcon}}</view>
      <view class="status-info">
        <text class="status-text" style="color: {{order.statusColor}}">{{order.statusText}}</text>
        <text class="status-time">{{order.updatedAt || order.createdAt}}</text>
      </view>
    </view>

    <!-- 活动信息 -->
    <view class="section-card">
      <view class="section-title">活动信息</view>
      <view wx:if="{{activityInfo}}" class="activity-info">
        <image class="activity-cover" src="{{activityInfo.coverImage}}" mode="aspectFill"></image>
        <view class="activity-details">
          <text class="activity-title">{{activityInfo.title}}</text>
          <text class="activity-subtitle">{{activityInfo.subtitle}}</text>
          <text class="activity-price">¥{{order.totalPrice}}</text>
        </view>
      </view>
      <view wx:else class="no-data">活动已删除</view>
    </view>

    <!-- 摄影师信息 -->
    <view wx:if="{{photographerInfo}}" class="section-card">
      <view class="section-title">摄影师信息</view>
      <view class="photographer-info">
        <image wx:if="{{photographerInfo.avatar}}" class="photographer-avatar" src="{{photographerInfo.avatar}}" mode="aspectFill"></image>
        <view wx:else class="photographer-avatar-placeholder">{{photographerInfo.name.substring(0,1)}}</view>
        <view class="photographer-details">
          <text class="photographer-name">{{photographerInfo.name}}</text>
          <text class="photographer-specialty">{{photographerInfo.specialty || '专业摄影师'}}</text>
        </view>
      </view>
    </view>

    <!-- 订单信息 -->
    <view class="section-card">
      <view class="section-title">订单信息</view>
      <view class="info-row">
        <text class="label">订单号</text>
        <text class="value code">{{order.orderNo || order._id.slice(-12)}}</text>
      </view>
      <view class="info-row">
        <text class="label">创建时间</text>
        <text class="value">{{order.createdAt}}</text>
      </view>
      <view class="info-row">
        <text class="label">订单金额</text>
        <text class="value price">¥{{order.totalPrice}}</text>
      </view>
      <view wx:if="{{order.remark}}" class="info-row">
        <text class="label">备注</text>
        <text class="value">{{order.remark}}</text>
      </view>
      <view wx:if="{{order.afterSaleReason}}" class="info-row">
        <text class="label">售后原因</text>
        <text class="value">{{order.afterSaleReason}}</text>
      </view>
    </view>

    <!-- 操作按钮 -->
    <view wx:if="{{order.userActions && order.userActions.length > 0}}" class="action-bar">
      <view
        wx:for="{{order.userActions}}"
        wx:key="index"
        wx:for-item="action"
        class="action-button action-{{action}}"
        bindtap="handleAction"
        data-action="{{action}}"
      >
        {{action === 'pay' ? '立即支付' : action === 'cancel' ? '取消订单' : action === 'contact' ? '联系摄影师' : action === 'after_sale' ? '申请售后' : action === 'evaluate' ? '评价' : action}}
      </view>
    </view>
  </view>
</view>

