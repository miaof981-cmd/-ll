# 📋 完整功能测试清单

## 🎯 测试前准备

1. **重新编译小程序**
   - 在开发者工具中点击"编译"按钮
   - 或按快捷键 `Cmd + B` (Mac) / `Ctrl + B` (Windows)

2. **清除缓存**
   - 顶部菜单：工具 → 清除缓存 → 清除工具缓存数据
   - 勾选所有选项
   - 点击"清除"

3. **打开 Console**
   - 顶部菜单：调试 → 调试器
   - 选择 Console 标签
   - 观察日志输出

---

## ✅ 测试用例 1：管理员登录

### 步骤：
1. 进入登录页面
2. 切换到"管理员登录"
3. 输入：
   - 用户名：`admin`
   - 密码：`admin123`
4. 点击"登录"

### 预期结果：
- ✅ 弹出"登录成功"提示
- ✅ 自动跳转到管理后台页面
- ✅ Console 显示：
  ```
  ✅ 云端获取学生成功: X
  ✅ 云端获取轮播图成功: X
  ✅ 云端获取公告成功: X
  ✅ 云端获取摄影师成功: X
  ✅ 统计数据: {...}
  ```

---

## ✅ 测试用例 2：添加轮播图

### 步骤：
1. 在管理后台点击"轮播图管理"
2. 点击"添加轮播图"
3. 选择一张图片上传
4. 等待上传完成

### 预期结果：
- ✅ 显示"上传中..."加载提示
- ✅ Console 显示：
  ```
  ✅ 图片上传成功: cloud://cloud1-9gdsq5jxb7e60ab4.../banners/...jpg
  ✅ 云端添加轮播图成功
  ```
- ✅ 轮播图列表中显示新上传的图片
- ✅ 图片可以正常显示（不是裂图）

### 测试完整性：
1. **返回首页** → 查看轮播图是否显示
2. **删除轮播图** → 确认是否删除成功

---

## ✅ 测试用例 3：发布公告

### 步骤：
1. 在管理后台点击"公告管理"
2. 点击"新建公告"
3. 填写信息：
   - 标题：测试公告标题
   - 内容：这是一条测试公告内容，用于验证云数据库功能是否正常。
4. 点击"上传封面"，选择图片
5. 点击"保存"

### 预期结果：
- ✅ Console 显示：
  ```
  ✅ 封面上传成功: cloud://...
  ✅ 云端添加公告成功
  ```
- ✅ 弹出"保存成功"提示
- ✅ 公告列表中显示新公告
- ✅ 封面图片正常显示

### 测试完整性：
1. **返回首页** → 查看公告列表是否显示新公告
2. **点击公告** → 查看是否能查看详情
3. **编辑公告** → 修改内容后保存，查看是否更新成功
4. **删除公告** → 确认是否删除成功

---

## ✅ 测试用例 4：添加摄影师

### 步骤：
1. 在管理后台点击"摄影师管理"
2. 点击"添加摄影师"
3. 填写信息：
   - 姓名：李四
   - 专长：儿童摄影
   - 简介：专业儿童摄影师，10年经验
4. 点击"上传头像"，选择图片
5. 点击"保存"

### 预期结果：
- ✅ Console 显示：
  ```
  ✅ 头像上传成功: cloud://...
  ✅ 云端保存摄影师成功
  ```
- ✅ 弹出"添加成功"提示
- ✅ 返回摄影师列表，显示新摄影师
- ✅ 头像正常显示

### 测试完整性：
1. **编辑摄影师** → 修改信息后保存
2. **删除摄影师** → 确认是否删除成功

---

## ✅ 测试用例 5：添加学生

### 步骤：
1. 在管理后台点击"学生管理"
2. 点击"新建学生"
3. 填写信息：
   - 学生姓名：王小明
   - 家长姓名：王明
4. 点击"上传录取通知书"，选择图片
5. 点击"保存"

### 预期结果：
- ✅ Console 显示：
  ```
  ✅ 录取通知书上传成功: cloud://...
  ✅ 新学生添加成功: {studentId: "20250001", ...}
  ```
- ✅ 弹出"保存成功"提示
- ✅ 自动生成学号（如：20250001）
- ✅ 默认密码：123456
- ✅ 学生列表中显示新学生

### 记录信息：
**请记下新学生的学号和密码，用于后续登录测试！**
- 学号：__________
- 密码：123456

---

## ✅ 测试用例 6：登录状态持久化

### 步骤：
1. 确保已登录管理员账号
2. 点击底部 TabBar 的"首页"
3. 再点击"我的"

### 预期结果：
- ✅ "我的"页面显示管理员信息
- ✅ 显示"管理后台"入口
- ✅ 不显示"请先登录"提示

### 步骤（模拟小程序重启）：
1. 关闭模拟器（点击右上角关闭按钮）
2. 重新编译小程序
3. 直接进入"我的"页面

### 预期结果：
- ✅ 仍然保持登录状态
- ✅ 显示管理员信息
- ✅ Console 显示：
  ```
  从持久化存储恢复登录状态
  ```

---

## ✅ 测试用例 7：学生登录

### 步骤：
1. 退出管理员登录
2. 进入登录页面
3. 切换到"学生/家长登录"
4. 输入：
   - 学号：（之前创建的学号，如：20250001）
   - 密码：123456
5. 点击"登录"

### 预期结果：
- ✅ Console 显示：
  ```
  ✅ 获取学生数据: 1
  ✅ 找到学生: {studentId: "20250001", name: "王小明", ...}
  ```
- ✅ 弹出"登录成功"提示
- ✅ 自动跳转到档案页面
- ✅ 显示学生档案信息

---

## ✅ 测试用例 8：档案查看

### 步骤：
1. 使用学生账号登录
2. 查看档案页面
3. 切换不同的标签（成绩、处分、图片）

### 预期结果：
- ✅ Console 显示：
  ```
  📡 加载学生档案: 20250001
  ✅ 档案记录数量: X
  ```
- ✅ 档案信息正常显示
- ✅ 如果有图片，点击可预览

---

## ✅ 测试用例 9：返回首页登录状态保持

### 步骤：
1. 管理员登录
2. 进入管理后台
3. 点击底部 TabBar 的"首页"
4. 查看首页是否显示轮播图和公告
5. 再次点击"我的"

### 预期结果：
- ✅ 首页正常显示轮播图和公告
- ✅ "我的"页面仍显示管理员身份
- ✅ 不需要重新登录

---

## ✅ 测试用例 10：手机预览

### 步骤：
1. 点击开发者工具顶部的"预览"按钮
2. 使用手机微信扫描二维码
3. 在手机上测试以下功能：
   - 管理员登录
   - 查看首页轮播图和公告
   - 返回"我的"页面，查看登录状态

### 预期结果：
- ✅ 手机上能正常打开小程序
- ✅ 轮播图和公告图片正常显示（不是裂图）
- ✅ 登录后返回首页，登录状态保持
- ✅ 数据与开发者工具同步

---

## 🐛 常见问题排查

### 问题：图片显示裂图或加载失败
**排查步骤：**
1. 打开 Console，查看是否有上传成功的日志
2. 检查图片URL是否以 `cloud://` 开头
3. 如果是 `http://127.0.0.1` 开头，说明还在使用临时路径，需要重新上传

### 问题：保存数据失败
**排查步骤：**
1. 查看 Console 错误信息
2. 如果提示"collection not exists"，去云开发控制台创建对应集合
3. 如果提示"Invalid Key Name: _id"，说明代码还没更新，重新编译

### 问题：登录后返回首页，登录状态丢失
**排查步骤：**
1. 打开 Console，输入：`console.log(wx.getStorageSync('userInfo'))`
2. 如果输出为空，说明登录时没有保存
3. 重新登录，查看 Console 是否有"持久化存储登录状态"的日志

### 问题：学生登录提示"学号或密码错误"
**排查步骤：**
1. 确认云数据库中是否有该学生数据
2. 查看 Console 输出：`✅ 获取学生数据: X`
3. 如果学生数量为 0，说明还没有添加学生
4. 在管理后台添加学生后重试

---

## 📊 测试结果记录表

| 测试用例 | 状态 | 备注 |
|---------|------|------|
| 1. 管理员登录 | ⬜ | |
| 2. 添加轮播图 | ⬜ | |
| 3. 发布公告 | ⬜ | |
| 4. 添加摄影师 | ⬜ | |
| 5. 添加学生 | ⬜ | 学号：_______ |
| 6. 登录状态持久化 | ⬜ | |
| 7. 学生登录 | ⬜ | |
| 8. 档案查看 | ⬜ | |
| 9. 返回首页登录状态保持 | ⬜ | |
| 10. 手机预览 | ⬜ | |

**测试完成后，请把结果发给我！** ✅ = 通过，❌ = 失败

---

## 🎯 重点测试项目

以下是**最关键**的测试项目，务必确保通过：

1. ✅ **发布公告后，首页能立即显示** ← 解决你之前提到的问题
2. ✅ **管理员返回首页后，登录状态不丢失** ← 解决你之前提到的问题
3. ✅ **所有图片正常显示，不是裂图** ← 确保云存储工作正常
4. ✅ **手机预览时数据同步** ← 确保云数据库工作正常

---

开始测试吧！有任何问题随时告诉我！🚀

